<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conciencia Fonol칩gica - Clase 3췈B</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Animaciones personalizadas */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        /* Ocultar scrollbar */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-sky-100 to-indigo-100 min-h-screen font-sans">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONOS (Inline SVGs para no depender de librer칤as externas) ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Volume2 = (props) => <IconBase {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07" /></IconBase>;
        const Star = (props) => <IconBase {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></IconBase>;
        const Users = (props) => <IconBase {...props}><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M23 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></IconBase>;
        const Music = (props) => <IconBase {...props}><path d="M9 18V5l12-2v13" /><circle cx="6" cy="18" r="3" /><circle cx="18" cy="16" r="3" /></IconBase>;
        const Sparkles = (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" /><path d="M5 3v4" /><path d="M9 5h4" /><path d="M5 21v-4" /><path d="M9 19h4" /></IconBase>;
        const Layout = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2" /><line x1="3" x2="21" y1="9" y2="9" /><line x1="9" x2="9" y1="9" y2="21" /></IconBase>;
        // CORREGIDO: Renombrado a Grid para que coincida con el uso en el bot칩n
        const Grid = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2" /><line x1="3" x2="21" y1="9" y2="9" /><line x1="3" x2="21" y1="15" y2="15" /><line x1="9" x2="9" y1="3" y2="21" /><line x1="15" x2="15" y1="3" y2="21" /></IconBase>;
        const PenTool = (props) => <IconBase {...props}><path d="m12 19 7-7 3 3-7 7-3-3z" /><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" /><path d="m2 2 7.586 7.586" /><circle cx="11" cy="11" r="2" /></IconBase>;
        const Trash2 = (props) => <IconBase {...props}><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" x2="10" y1="11" y2="17" /><line x1="14" x2="14" y1="11" y2="17" /></IconBase>;
        const Eraser = (props) => <IconBase {...props}><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21" /><path d="M22 21H7" /><path d="m5 11 9 9" /></IconBase>;
        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></IconBase>;
        const Info = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10" /><path d="M12 16v-4" /><path d="M12 8h.01" /></IconBase>;

        // --- COMPONENTE PRINCIPAL ---
        function App() {
            const [mode, setMode] = useState('alphabet'); // 'alphabet', 'syllables', 'writing', 'paragraph'
            const [selectedLetter, setSelectedLetter] = useState(null);
            const [currentExample, setCurrentExample] = useState(null);
            const [animationClass, setAnimationClass] = useState('');
            
            // Estados para el modo S칤labas
            const [syllableConsonant, setSyllableConsonant] = useState(null);
            const [syllableVowel, setSyllableVowel] = useState(null);
            const [formedSyllable, setFormedSyllable] = useState('');
            const [syllableExample, setSyllableExample] = useState('');

            // Estados para el modo Escritura
            const [writtenWord, setWrittenWord] = useState('');
            const [isAccentActive, setIsAccentActive] = useState(false);

            // Estados para el modo P치rrafo Loco
            const [paragraphPhase, setParagraphPhase] = useState('setup1'); // setup1, setup2, memory, reading
            const [paraSyllable1, setParaSyllable1] = useState('');
            const [paraSyllable2, setParaSyllable2] = useState('');
            const [currentParaLetters, setCurrentParaLetters] = useState([]);
            const [paragraphTextWords, setParagraphTextWords] = useState([]);
            const [foundWords, setFoundWords] = useState([]); 

            // Mapeo de acentos
            const accentedVowels = {
                'A': '츼', 'E': '칄', 'I': '칈', 'O': '칍', 'U': '칔'
            };

            // DICCIONARIO FON칄TICO PERSONALIZADO
            const phoneticSounds = {
                'A': 'A', 'E': 'E', 'I': 'I', 'O': 'O', 'U': 'U',
                'M': 'Emm', 'S': 'Sesss', 'L': 'Elll', 'F': 'Efff', 'N': 'Ennn',
                'R': 'Errrrr', 'J': 'Jo', // J como Jo (o muy corta)
                'Z': 'Cee', 'Y': 'Ye', 'X': 'Sesss',
                'H': ' ', 
                'B': 'B', 'C': 'C', 'D': 'D', 'G': 'G', 'K': 'K', 
                'P': 'P', 'Q': 'Q', 'T': 'T', 'V': 'V', 'W': 'W', '칌': '칌'
            };

            // DATOS MASIVOS (Integraci칩n de archivos Alumnos, Profesores, Escenarios y Diccionario)
            const letterData = {
                'A': ['Abie', 'Ander', 'Adri치n', '츼frica', '츼ngel', 'Aida', 'Antromero', 'Albandi', 'abanico', 'abierto', 'abogado', 'abrazo', 'abril', 'abril', 'abuelo', 'acci칩n', 'aceite', 'aceptar', 'acero', 'acto', 'actual', 'acuerdo', 'adelante', 'adivinar', 'admirar', 'aduana', 'adulto', 'a칠reo', 'afectar', 'afici칩n', 'agenda', 'agente', 'agitar', 'agosto', 'agua', 'aguja', 'ahora', 'aire', 'ajedrez', 'ala', 'alambre', 'alarma', 'alba', 'alcance', 'alcohol', 'alegr칤a', 'alfa', 'algo', 'algod칩n', 'alguien', 'alma', 'almohada', 'almorzar', 'alto', 'altura', 'alumno', 'alzar', 'amable', 'amanecer', 'amargo', 'amarillo', 'ambiente', 'amigo', 'amistad', 'amor', 'amplio', 'analizar', 'ancho', 'anciano', 'andar', '치ngel', '치ngulo', 'anillo', 'animal', '치nimo', 'anoche', 'ante', 'anteojos', 'antes', 'antiguo', 'anual', 'a침o', 'apagar', 'aparato', 'aparte', 'apellido', 'apenas', 'aplicar', 'apoyo', 'aprender', 'aprobar', 'apto', 'aquel', 'aqu칤', 'ara침a', '치rbol', 'archivo', 'arco', 'arder', '치rea', 'arena', 'arma', 'armario', 'aroma', 'arriba', 'arroba', 'arroz', 'arte', 'arteria', 'art칤culo', 'artista', 'asado', 'asco', 'ascensor', 'asegurar', 'as칤', 'asiento', 'asignar', 'asistir', 'aspecto', '치spero', 'asunto', 'atacar', 'atar', 'atenci칩n', 'atl치ntico', 'atm칩sfera', '치tomo', 'atr치s', 'aula', 'aumento', 'ausencia', 'auto', 'autob칰s', 'autor', 'autorizar', 'avance', 'avanzar', 'avenida', 'aventura', 'avisar', 'aviso', 'ayer', 'ayuda', 'ayudar', 'ayuntamiento', 'azafr치n', 'azar', 'azul'],
                'B': ['Biblioteca Cand치s', 'Bot치nico', 'Bocata', 'baile', 'bajar', 'bajo', 'bala', 'balance', 'balc칩n', 'banco', 'bandera', 'ba침o', 'barato', 'barba', 'barco', 'barra', 'barrer', 'barrio', 'base', 'bastante', 'bast칩n', 'basura', 'batalla', 'bater칤a', 'beb칠', 'beber', 'bebida', 'beca', 'belleza', 'bello', 'besar', 'beso', 'bestia', 'biblioteca', 'bicicleta', 'bien', 'bienestar', 'bigote', 'billete', 'blanco', 'blando', 'bloquear', 'boca', 'boda', 'bodega', 'bola', 'boleto', 'bolsa', 'bolsillo', 'bomba', 'bondad', 'bonito', 'borde', 'bosque', 'bota', 'botella', 'bot칩n', 'brazo', 'b칰ho', 'buitre', 'buque', 'burbuja', 'buscar', 'butaca', 'buz칩n'],
                'C': ['Cand치s', 'Cristina', 'Carnaval', 'Carre침o', 'Centro de Consumo Lugones', 'caballo', 'caba침a', 'cabello', 'cabeza', 'cable', 'cabo', 'cabra', 'cacao', 'cacerola', 'cachete', 'cada', 'cadena', 'caer', 'caf칠', 'ca칤da', 'caja', 'caj칩n', 'cal', 'calamar', 'calcular', 'caldo', 'calendario', 'calentar', 'calidad', 'c치lido', 'caliente', 'calle', 'calma', 'calor', 'calvo', 'cama', 'c치mara', 'camarero', 'cambiar', 'cambio', 'caminar', 'camino', 'cami칩n', 'camisa', 'campo', 'canal', 'canasta', 'cancelar', 'canci칩n', 'candado', 'canela', 'cansar', 'cantar', 'cantidad', 'ca침a', 'capa', 'capacidad', 'capaz', 'capital', 'capricho', 'captar', 'cara', 'car치cter', 'carb칩n', 'c치rcel', 'careta', 'carga', 'cargar', 'cargo', 'caricia', 'caridad', 'cari침o', 'carne', 'carrera', 'carretera', 'carro', 'carta', 'cartel', 'cartera', 'cart칩n', 'casa', 'casar', 'cascada', 'casco', 'casi', 'caso', 'castigo', 'castillo', 'casual', 'cat치logo', 'causa', 'causar', 'cazar', 'cebolla', 'ceder', 'ciego', 'cielo', 'ciencia', 'ciento', 'cierre', 'cigarro', 'cima', 'cinco', 'cine', 'cinta', 'cintur칩n', 'c칤rculo', 'ciruela', 'ciudad', 'civil', 'claro', 'clase', 'clave', 'clavo', 'cliente', 'clima', 'cl칤nica', 'cobre', 'cocina', 'cocinar', 'coco', 'c칩digo', 'codo', 'coger', 'cohete', 'cola', 'colch칩n', 'colecci칩n', 'colegio', 'colgar', 'colina', 'collar', 'color', 'columna', 'combate', 'comer', 'comercio', 'comida', 'comienzo', 'como', 'c칩modo', 'compa침ero', 'compa침칤a', 'comparar', 'comp치s', 'compra', 'comprar', 'com칰n', 'con', 'concepto', 'conciencia', 'concreto', 'condici칩n', 'conducir', 'conducta', 'conejo', 'confianza', 'confiar', 'conflicto', 'congelar', 'conjunto', 'conocer', 'conocimiento', 'conquista', 'consejo', 'conservar', 'considerar', 'consuelo', 'contar', 'contacto', 'contener', 'contento', 'contestar', 'contigo', 'continuo', 'contra', 'control', 'convencer', 'conversar', 'copa', 'copia', 'copiar', 'coraz칩n', 'corbata', 'corcho', 'cordero', 'cord칩n', 'corona', 'corral', 'correa', 'correo', 'correr', 'corriente', 'cortar', 'corte', 'corteza', 'cortina', 'corto', 'cosa', 'coser', 'cosmos', 'costa', 'costo', 'costumbre', 'crear', 'crecer', 'cr칠dito', 'creer', 'crema', 'criar', 'crimen', 'cristal', 'cruce', 'crudo', 'cruel', 'cruzar', 'cruz', 'cuaderno', 'cuadro', 'cual', 'cualquier', 'cuando', 'cuanto', 'cuartel', 'cuarto', 'cuatro', 'cubrir', 'cuchara', 'cuchillo', 'cuello', 'cuerda', 'cuerno', 'cuero', 'cuerpo', 'cuesti칩n', 'cueva', 'cuidado', 'cuidar', 'culpa', 'cultura', 'cumbre', 'cumplir', 'cuna', 'cuota', 'cup칩n', 'cura', 'curar', 'curioso', 'curso', 'curva'],
                'D': ['Dedo', 'Delf칤n', 'dama', 'danza', 'da침ar', 'da침o', 'dar', 'dato', 'debate', 'deber', 'd칠bil', 'd칠cada', 'decente', 'decir', 'decisi칩n', 'declarar', 'decorar', 'dedo', 'defecto', 'defender', 'defensa', 'definir', 'dejar', 'del', 'delante', 'delgado', 'delicado', 'delito', 'demanda', 'dem치s', 'democracia', 'demonio', 'demostrar', 'denso', 'dentro', 'depender', 'deporte', 'derecho', 'derivar', 'derrota', 'desayuno', 'descansar', 'descanso', 'descender', 'desconocido', 'describir', 'descubrir', 'desde', 'desear', 'deseo', 'desierto', 'despacho', 'despertar', 'despu칠s', 'destino', 'destruir', 'detalle', 'detener', 'deuda', 'd칤a', 'diablo', 'di치logo', 'diamante', 'diario', 'dibujar', 'dibujo', 'diccionario', 'diciembre', 'dictar', 'diente', 'dieta', 'diez', 'diferencia', 'diferente', 'dif칤cil', 'digital', 'dignidad', 'dinero', 'dios', 'direcci칩n', 'directo', 'director', 'dirigir', 'disco', 'dise침o', 'disfrutar', 'disparo', 'distancia', 'distinto', 'diverso', 'divertir', 'dividir', 'divino', 'do', 'doblar', 'doble', 'doce', 'doctor', 'documento', 'd칩lar', 'doler', 'dolor', 'dom칠stico', 'domingo', 'don', 'donar', 'donde', 'dorado', 'dormir', 'dorso', 'dos', 'dosis', 'drag칩n', 'drama', 'droga', 'ducha', 'duda', 'dudar', 'due침o', 'dulce', 'duplicar', 'duro'],
                'E': ['Elsa', 'Eloy', 'Eva', 'Escuela-cocina de Perlora', 'Escenarios', 'echar', 'eco', 'econom칤a', 'edad', 'edificio', 'editor', 'educaci칩n', 'educar', 'efecto', 'eficaz', 'ego칤smo', 'eje', 'ejecutar', 'ejemplo', 'ejercicio', 'ej칠rcito', 'el', 'elecci칩n', 'el칠ctrico', 'elefante', 'elegir', 'elemento', 'elevar', 'ella', 'ellos', 'embargo', 'emergencia', 'emitir', 'emoci칩n', 'empujar', 'en', 'enamorar', 'encanto', 'encender', 'encierra', 'encima', 'encontrar', 'encuentro', 'enemigo', 'energ칤a', 'enero', 'enfermedad', 'enfermo', 'enga침ar', 'enigma', 'enlace', 'enorme', 'ense침ar', 'entender', 'enterar', 'entero', 'entonces', 'entrada', 'entrar', 'entre', 'entrega', 'entregar', 'entrenar', 'entrar', 'enviar', 'envidia', '칠poca', 'equilibrio', 'equipo', 'error', 'escalera', 'escapar', 'escena', 'esclavo', 'escribir', 'escrito', 'escuchar', 'escudo', 'escuela', 'ese', 'esfuerzo', 'espacio', 'espada', 'espalda', 'espejo', 'espera', 'esperanza', 'esperar', 'espeso', 'esp칤a', 'espina', 'esp칤ritu', 'esposa', 'esposo', 'espuma', 'esquema', 'esquina', 'esta', 'establecer', 'estaci칩n', 'estado', 'estallar', 'estanque', 'estar', 'estatua', 'este', 'estilo', 'estimar', 'estirar', 'esto', 'estrella', 'estructura', 'estudiar', 'estudio', 'estufa', 'etapa', 'eterno', 'etiqueta', 'europa', 'evento', 'evitar', 'evoluci칩n', 'exacto', 'examen', 'examinar', 'excelente', 'exceso', 'excusa', '칠xito', 'explicar', 'explorar', 'explosi칩n', 'exponer', 'exportar', 'expresar', 'exterior', 'extra침o', 'extremo'],
                'F': ['Furada', 'f치brica', 'fabricar', 'f치cil', 'factor', 'factura', 'facultad', 'falda', 'falta', 'faltar', 'fama', 'familia', 'famoso', 'fantas칤a', 'fantasma', 'farmacia', 'faro', 'fase', 'fatal', 'favor', 'fe', 'febrero', 'fecha', 'felicidad', 'feliz', 'feo', 'feria', 'feriado', 'f칠rtil', 'fiar', 'fibra', 'ficha', 'fiel', 'fiesta', 'figura', 'fijar', 'fila', 'filete', 'filo', 'filtro', 'fin', 'final', 'financiar', 'finca', 'fino', 'firma', 'firmar', 'firme', 'f칤sica', 'flaco', 'flama', 'flecha', 'flor', 'flota', 'fluir', 'flujo', 'foco', 'folio', 'fondo', 'forma', 'formar', 'f칩rmula', 'fortuna', 'forzar', 'foto', 'fracaso', 'fr치gil', 'fragmento', 'frase', 'frasco', 'freno', 'frente', 'fresa', 'fresco', 'fr칤o', 'frontera', 'frotar', 'fruta', 'fruto', 'fuego', 'fuente', 'fuera', 'fuerte', 'fuerza', 'fuga', 'fumar', 'funci칩n', 'funda', 'fundar', 'furia', 'f칰tbol', 'futuro'],
                'G': ['Gij칩n', 'Gorra', 'Gusano', 'gabardina', 'gafas', 'gala', 'galaxia', 'galer칤a', 'gallina', 'gallo', 'gana', 'ganancia', 'ganar', 'gancho', 'ganga', 'garaje', 'garant칤a', 'garganta', 'gas', 'gasolina', 'gastar', 'gasto', 'gato', 'general', 'g칠nero', 'generoso', 'genio', 'gente', 'geograf칤a', 'gesto', 'gigante', 'girar', 'giro', 'globo', 'gloria', 'gobernar', 'gobierno', 'golpe', 'golpear', 'goma', 'gordo', 'gota', 'gozar', 'gracia', 'grado', 'gr치fico', 'gran', 'grande', 'grano', 'grapa', 'gratis', 'grave', 'gris', 'gritar', 'grito', 'grueso', 'grupo', 'guante', 'guapo', 'guardia', 'guerra', 'gu칤a', 'guiar', 'gusano', 'gusto'],
                'H': ['Helio', 'Helados Helio', 'haber', 'h치bil', 'habitaci칩n', 'h치bito', 'hablar', 'hacer', 'hacia', 'hacha', 'hada', 'hallar', 'hambre', 'harina', 'hasta', 'hay', 'haza침a', 'hebilla', 'hecho', 'helado', 'hembra', 'herida', 'herir', 'hermana', 'hermano', 'hermoso', 'h칠roe', 'herramienta', 'hervir', 'hielo', 'hierba', 'hierro', 'h칤gado', 'hija', 'hijo', 'hilo', 'himno', 'historia', 'hogar', 'hoja', 'hola', 'hombre', 'hombro', 'hondo', 'honor', 'honra', 'hora', 'horario', 'horizonte', 'hormiga', 'horno', 'horror', 'hospital', 'hotel', 'hoy', 'hoyo', 'hueco', 'huelga', 'huella', 'huerta', 'hueso', 'huevo', 'huir', 'humanidad', 'humano', 'h칰medo', 'humildad', 'humo', 'humor', 'hundir', 'hurac치n'],
                'I': ['Izan', 'idea', 'ideal', 'idioma', '칤dolo', 'iglesia', 'ignorar', 'igual', 'ilegal', 'ilusi칩n', 'imagen', 'imaginar', 'im치n', 'imitar', 'impacto', 'impedir', 'imperio', 'implicar', 'importar', 'importe', 'imposible', 'imprenta', 'imprimir', 'impuesto', 'impulso', 'impuro', 'incendio', 'incluir', 'incluso', 'indicar', '칤ndice', 'industria', 'infantil', 'infierno', 'infinito', 'inflar', 'informar', 'informe', 'ingeniero', 'ingl칠s', 'ingresar', 'ingreso', 'iniciar', 'inicio', 'injusto', 'inmediato', 'inmenso', 'inm칩vil', 'inocente', 'inquieto', 'insecto', 'insistir', 'instalar', 'instante', 'instinto', 'insulto', 'intacto', '칤ntegro', 'intelecto', 'intenci칩n', 'intentar', 'intento', 'inter칠s', 'interior', 'interno', '칤ntimo', 'in칰til', 'invasi칩n', 'inventar', 'invento', 'invierno', 'invitar', 'ir', 'ira', 'iron칤a', 'isla'],
                'J': ['Jon치s', 'Juanjo', 'Jard칤n Bot치nico', 'jab칩n', 'jam칩n', 'jard칤n', 'jarra', 'jaula', 'jefe', 'jerarqu칤a', 'jeringa', 'jinete', 'jornada', 'joven', 'joya', 'jud칤o', 'juego', 'jueves', 'juez', 'jugar', 'jugo', 'juguete', 'juicio', 'julio', 'junio', 'junta', 'juntar', 'junto', 'jurar', 'justicia', 'justo', 'juventud', 'juzgar'],
                'K': ['Kiwi', 'Koala', 'kilo', 'kil칩metro'], 
                'L': ['Lucas', 'Lugones', 'Llinu', 'Luanco', 'Logrezana', 'labio', 'labor', 'labrar', 'lado', 'ladrillo', 'ladr칩n', 'lago', 'l치grima', 'laguna', 'lamentar', 'l치mpara', 'lana', 'lanzar', 'l치piz', 'largo', 'lata', 'lat칤n', 'latir', 'lavar', 'lazo', 'leal', 'lecci칩n', 'leche', 'lecho', 'leer', 'legal', 'legi칩n', 'legislar', 'leg칤timo', 'lejos', 'lengua', 'lenguaje', 'lento', 'le침a', 'le칩n', 'lepra', 'lesi칩n', 'letra', 'levantar', 'ley', 'leyenda', 'liberar', 'libertad', 'libra', 'libre', 'libro', 'licencia', 'l칤der', 'liebre', 'lienzo', 'liga', 'ligar', 'ligero', 'lima', 'l칤mite', 'lim칩n', 'limpiar', 'limpio', 'lindo', 'l칤nea', 'lino', 'l칤quido', 'lista', 'listo', 'litro', 'lobo', 'local', 'loco', 'locura', 'lodo', 'l칩gica', 'lograr', 'lomo', 'lona', 'longitud', 'lote', 'lucha', 'luchar', 'luego', 'lugar', 'lujo', 'luna', 'lunes', 'lupa', 'luz', 'llama', 'llamar', 'llano', 'llanto', 'llave', 'llegar', 'llenar', 'lleno', 'llevar', 'llorar', 'llover', 'lluvia'],
                'M': ['Mario', 'Museo Ant칩n', 'Muelle', 'maceta', 'macho', 'madera', 'madre', 'maduro', 'maestro', 'magia', 'm치gico', 'ma칤z', 'mal', 'maleta', 'maldad', 'malo', 'mam치', 'mancha', 'mandar', 'mando', 'manera', 'manga', 'mango', 'man칤a', 'manifestar', 'mano', 'manso', 'manta', 'manteca', 'mantener', 'manual', 'ma침ana', 'mapa', 'm치quina', 'mar', 'maravilla', 'marca', 'marcar', 'marco', 'marcha', 'marea', 'mareo', 'margen', 'marido', 'marinero', 'mariposa', 'm치rmol', 'marr칩n', 'martes', 'marzo', 'mas', 'm치s', 'masa', 'm치scara', 'matar', 'materia', 'matiz', 'matriz', 'm치ximo', 'mayo', 'mayor', 'mayor칤a', 'me', 'mecanismo', 'medalla', 'media', 'medicina', 'm칠dico', 'medida', 'medio', 'medir', 'meditar', 'mejor', 'mejorar', 'mel칩n', 'melod칤a', 'memoria', 'menci칩n', 'menor', 'menos', 'mensaje', 'mente', 'men칰', 'mercado', 'merecer', 'm칠rito', 'mermelada', 'mes', 'mesa', 'meta', 'metal', 'meter', 'm칠todo', 'metro', 'mezcla', 'mezclar', 'miedo', 'miel', 'miembro', 'mientras', 'mi칠rcoles', 'mil', 'milagro', 'militar', 'mill칩n', 'mimar', 'mina', 'mineral', 'm칤nimo', 'ministro', 'minor칤a', 'minuto', 'm칤o', 'mirada', 'mirar', 'misa', 'miserable', 'miseria', 'misi칩n', 'mismo', 'misterio', 'mitad', 'moda', 'modelo', 'modo', 'mojar', 'molde', 'moler', 'molino', 'momento', 'momia', 'moneda', 'monitor', 'monje', 'mono', 'monta침a', 'montar', 'monte', 'mont칩n', 'moral', 'morder', 'moreno', 'morir', 'mosca', 'mostrar', 'motivo', 'motor', 'mover', 'm칩vil', 'muchacho', 'mucho', 'mueble', 'muelle', 'muerte', 'muerto', 'muestra', 'mujer', 'multa', 'mundial', 'mundo', 'mu침eca', 'muro', 'm칰sculo', 'museo', 'm칰sica', 'muslo', 'mutuo', 'muy'],
                'N': ['Nayara', 'Noa', 'Nira', 'Navidad', 'Navidades', 'nacer', 'naci칩n', 'nada', 'nadar', 'nadie', 'naranja', 'nariz', 'narrar', 'nata', 'nativo', 'natural', 'nature', 'nave', 'navegar', 'navidad', 'necesario', 'necesidad', 'negar', 'negocio', 'negro', 'nervio', 'neto', 'neum치tico', 'neutro', 'nevada', 'nevar', 'ni', 'nido', 'niebla', 'nieto', 'nieve', 'ninguno', 'ni침a', 'ni침o', 'nivel', 'no', 'noble', 'noche', 'nombre', 'norma', 'norte', 'nota', 'notar', 'noticia', 'novela', 'novio', 'nube', 'n칰cleo', 'nudo', 'nuera', 'nuestro', 'nueve', 'nuevo', 'nuez', 'n칰mero', 'nunca', 'nutrir'],
                '칌': ['칌u', 'Pi침a', 'Ca침a', 'ni침o', 'ni침a', 'ma침ana', 'pa침uelo', 'a침o', 'ara침a', 'ba침o', 'caba침a', 'ca침a', 'monta침a', 'mu침eca', 'pu침o', 'sue침o', 'oto침o', 'le침a', 'acompa침ar', 'da침o', 'peque침o', 'se침al', 'se침or'], 
                'P': ['Perlora', 'Prendes', 'Pe침치 Furada', 'Playa de la Palmera', 'Plaza Bocata', 'Playas de Carre침o', 'Playa', 'Palmera', 'Plaza', 'paciencia', 'paciente', 'pacto', 'padre', 'pagar', 'p치gina', 'pago', 'pa칤s', 'paisaje', 'paja', 'p치jaro', 'pala', 'palabra', 'palacio', 'p치lido', 'palma', 'palo', 'paloma', 'pan', 'p치nico', 'pa침uelo', 'pap치', 'papel', 'paquete', 'par', 'para', 'parada', 'parar', 'pared', 'pareja', 'pariente', 'parque', 'p치rrafo', 'parte', 'partido', 'partir', 'parto', 'pasar', 'pasear', 'paseo', 'pasi칩n', 'paso', 'pasta', 'pastel', 'pasto', 'pata', 'patata', 'patio', 'patria', 'pausa', 'pauta', 'pavo', 'paz', 'pecado', 'pecho', 'pedazo', 'pedir', 'pegar', 'peinar', 'peine', 'pelea', 'pel칤cuar', 'peligro', 'pelo', 'pelota', 'pena', 'pendiente', 'pensar', 'pensi칩n', 'peor', 'peque침o', 'pera', 'perder', 'perd칩n', 'perfil', 'perfume', 'periodista', 'perla', 'permiso', 'permitir', 'pero', 'perro', 'persona', 'personaje', 'pertenecer', 'pesar', 'pesca', 'peso', 'pesta침a', 'petici칩n', 'pez', 'piano', 'picar', 'pico', 'pie', 'piedad', 'piedra', 'piel', 'pierna', 'pieza', 'pila', 'pilar', 'piloto', 'pimienta', 'pino', 'pintar', 'pintor', 'pintura', 'pi침a', 'pipa', 'pirata', 'pisar', 'piscina', 'piso', 'pista', 'pistola', 'pito', 'placer', 'plan', 'plancha', 'planea', 'planeta', 'plano', 'planta', 'plantar', 'plata', 'plato', 'playa', 'plaza', 'plazo', 'pleito', 'plomo', 'pluma', 'plural', 'pobre', 'poco', 'poder', 'poema', 'poeta', 'poes칤a', 'polic칤a', 'pol칤tica', 'polvo', 'pollo', 'poner', 'popular', 'por', 'porcentaje', 'porque', 'portada', 'poseer', 'posible', 'posici칩n', 'postal', 'poste', 'postre', 'potencia', 'pozo', 'pr치ctica', 'prado', 'precio', 'preciso', 'preferir', 'pregunta', 'preguntar', 'premio', 'prensa', 'preocupar', 'preparar', 'presa', 'presencia', 'presentar', 'presente', 'presidente', 'preso', 'presi칩n', 'prestar', 'pr칠stamo', 'presumir', 'pretender', 'pretexto', 'previo', 'prima', 'primavera', 'primer', 'primo', 'principal', 'pr칤ncipe', 'principio', 'prisa', 'privar', 'probar', 'problema', 'proceso', 'producir', 'producto', 'profesi칩n', 'profesor', 'profundo', 'programa', 'prohibir', 'promesa', 'prometer', 'p', 'ronto', 'propio', 'propiedad', 'proteger', 'protesta', 'provecho', 'pr칩ximo', 'proyectar', 'proyecto', 'prueba', 'p칰blico', 'pueblo', 'puente', 'puerta', 'puerto', 'pues', 'puesto', 'pulgar', 'pulso', 'punta', 'punto', 'pu침o', 'pupila', 'puro'],
                'Q': ['Queta', 'Queso', 'qu칠', 'que', 'quedar', 'queja', 'quemar', 'querer', 'queso', 'quien', 'quieto', 'qu칤mica', 'quince', 'quinto', 'quitar', 'quiz치', 'parque', 'peque침o', 'toque', 'bosque', 'tanque', 'porque', 'aquel', 'aqui', 'equipo', 'esquema', 'esquina', 'etiqueta', 'izquierdo', 'maquina', 'orquesta', 'paquete', 'parque', 'raqueta', 'riqueza', 'seco', 'toque'],
                'R': ['Rafa', 'Roc칤o', 'Rub칠n', 'Rebolleres', 'Rula de Cand치s', 'rabia', 'rabo', 'racha', 'radiar', 'radio', 'ra칤z', 'rama', 'ramo', 'rana', 'r치pido', 'rapto', 'raro', 'rascacielos', 'rascar', 'rasgo', 'rastro', 'rata', 'rato', 'rat칩n', 'raya', 'rayo', 'raza', 'raz칩n', 'reacci칩n', 'real', 'realidad', 'rebelde', 'recibir', 'reciente', 'recio', 'reclamar', 'recoger', 'recomendar', 'reconocer', 'recordar', 'recto', 'recuerdo', 'red', 'redondo', 'reducir', 'reflejar', 'reforma', 'refr치n', 'refugio', 'regalo', 'regar', 'r칠gimen', 'regi칩n', 'registro', 'regla', 'regresar', 'reina', 'reino', 're칤r', 'reja', 'relaci칩n', 'relato', 'relieve', 'religi칩n', 'reloj', 'remar', 'remedio', 'remo', 'rencor', 'rendir', 'renta', 'reojo', 'reparar', 'reparo', 'repartir', 'repaso', 'repetir', 'reposo', 'representar', 'reprimir', 'reproche', 'reptil', 'rep칰blica', 'reserva', 'resistir', 'resolver', 'resonar', 'respeto', 'respirar', 'responder', 'respuesta', 'resto', 'resultado', 'resumen', 'retirar', 'retiro', 'retrato', 'reuni칩n', 'reunir', 'revelar', 'rev칠s', 'revista', 'revocar', 'revoluci칩n', 'rey', 'rezar', 'rico', 'riesgo', 'rinc칩n', 'r칤o', 'riqueza', 'risa', 'ritmo', 'rito', 'rival', 'robar', 'robo', 'robusto', 'roca', 'roc칤o', 'rodar', 'rodear', 'rodilla', 'rogar', 'rojo', 'rollo', 'romper', 'ronco', 'ropa', 'rosa', 'rostro', 'roto', 'rubio', 'rueda', 'ruego', 'ruido', 'ruina', 'rumbo', 'rumor', 'ruptura', 'rural', 'ruta', 'rutina'],
                'S': ['Selena', 'Sidrer칤as', 'Semana Santa', 'Salidas', 'saber', 'sabio', 'sabor', 'sacar', 'saco', 'sacudir', 'sagrado', 'sal', 'sala', 'salida', 'salir', 'sal칩n', 'salsa', 'saltar', 'salto', 'salud', 'saludar', 'saludo', 'salvaje', 'salvar', 'sangre', 'sano', 'santo', 'sapo', 'sastre', 'sat칠lite', 'satisfacer', 'sauce', 'seco', 'secreto', 'sector', 'secuestro', 'sed', 'seda', 'seguir', 'seg칰n', 'segundo', 'seguridad', 'seguro', 'seis', 'selva', 'sello', 'semana', 'sembrar', 'semejar', 'semilla', 'sencillo', 'senda', 'seno', 'sensaci칩n', 'sentido', 'sentir', 'se침al', 'se침alar', 'se침or', 'separar', 'septiembre', 'sepulcro', 'ser', 'serie', 'serio', 'serpiente', 'servicio', 'servir', 'sesenta', 'sesi칩n', 'setenta', 'severo', 'sexo', 'sexto', 'si', 's칤', 'siempre', 'sierra', 'siesta', 'siete', 'siglo', 'significar', 'signo', 's칤laba', 'silbar', 'silencio', 'silla', 'sill칩n', 's칤mbolo', 'simple', 'sin', 'sincero', 'singular', 'sino', 's칤ntoma', 'sistema', 'sitio', 'situaci칩n', 'soberbio', 'sobrar', 'sobre', 'sobrino', 'social', 'sociedad', 'socio', 'socorro', 'sof치', 'sol', 'sola', 'solar', 'soldado', 'soledad', 'solemne', 'soler', 'solicitar', 's칩lido', 'solitario', 'solo', 'soltar', 'soluci칩n', 'sombra', 'sombrero', 'sonar', 'sonda', 'sonido', 'sonre칤r', 'sonrisa', 'so침ar', 'sopa', 'soplar', 'sordo', 'sorpresa', 'sorteo', 'sospecha', 'sostener', 's칩tano', 'suave', 'subir', 'submarino', 'sucio', 'sudor', 'suegra', 'sueldo', 'suelo', 'sue침o', 'suerte', 'suficiente', 'sufrir', 'sugerir', 'suicidio', 'sujeto', 'suma', 'sumar', 'superar', 'superficie', 'superior', 'suplicar', 'suponer', 'sur', 'surco', 'surgir', 'suspiro', 'susto', 'sutil'],
                'T': ['Tymofii', 'Tamara', 'TPA Gijon', 'Teatro Prendes', 'TPA', 'tabaco', 'tabla', 'tablero', 'tacto', 'tal', 'taladro', 'tal칩n', 'talla', 'taller', 'tama침o', 'tambor', 'tampoco', 'tan', 'tanto', 'tapa', 'tapar', 'tapiz', 'tardar', 'tarde', 'tarea', 'tarjeta', 'tasa', 'taxi', 'taza', 'teatro', 'techo', 'tejer', 'tejido', 'tela', 'telara침a', 'tel칠fono', 'telegrama', 'tema', 'temblar', 'temer', 'temperatura', 'tempestad', 'templo', 'temporada', 'temprano', 'tenedor', 'tener', 'tensi칩n', 'tentar', 'teor칤a', 'terapia', 'tercero', 'terminar', 't칠rmino', 'term칩metro', 'terreno', 'terrible', 'terror', 'tesoro', 'testigo', 'texto', 't칤a', 'tiempo', 'tienda', 'tierno', 'tierra', 'tigre', 'tijeras', 'timbre', 't칤mido', 'tinta', 't칤o', 'tipo', 'tirar', 'tiro', 't칤tulo', 'toalla', 'tobillo', 'tocar', 'todo', 'toldo', 'tomar', 'tomate', 'tono', 'tonto', 'top', 'tope', 'toque', 't칩rax', 'tormenta', 'torneo', 'toro', 'torre', 'tortuga', 'total', 'trabajar', 'trabajo', 'traer', 'tr치fico', 'trago', 'traici칩n', 'traje', 'trampa', 'tramo', 'tranquilo', 'transformar', 'transporte', 'trapo', 'tras', 'traslado', 'tratar', 'trato', 'trav칠s', 'trazar', 'tr칠bol', 'trece', 'tremendo', 'tren', 'tres', 'tribu', 'tribunal', 'trigo', 'trimestre', 'triste', 'triunfo', 'trompa', 'tronco', 'tropa', 'trozo', 'trueno', 'tu', 't칰', 'tuber칤a', 'tubo', 'tumba', 'tumor', 't칰nel', 'turismo', 'turno', 'tutor', 'tuyo'],
                'U': ['Universo', 'Uvas', 'ubicar', 'u침a', '칰ltimo', '칰nico', 'unidad', 'unificar', 'uni칩n', 'unir', 'universo', 'uno', 'untar', 'urbano', 'urgente', 'usar', 'uso', 'usted', '칰til', 'uva'], 
                'V': ['Vacaciones', 'Verano', 'vaca', 'vacaci칩n', 'vac칤o', 'vago', 'vaina', 'valer', 'v치lido', 'valle', 'valor', 'v치lvula', 'valla', 'vampiro', 'vapor', 'vara', 'variable', 'variar', 'variedad', 'var칩n', 'vaso', 'vecino', 'vegetal', 'vejez', 'veintena', 'vejez', 'vela', 'velo', 'velocidad', 'vena', 'vencer', 'vender', 'veneno', 'venir', 'venta', 'ventaja', 'ventana', 'ver', 'verano', 'veras', 'verbo', 'verdad', 'verde', 'verdura', 'verg칲enza', 'verso', 'vertical', 'vestir', 'vestido', 'vez', 'v칤a', 'viajar', 'viaje', 'viajero', 'vibrar', 'vicio', 'v칤ctima', 'vida', 'vidrio', 'viejo', 'viento', 'vientre', 'viernes', 'viga', 'vigilar', 'vigor', 'villa', 'vinagre', 'vino', 'violencia', 'violento', 'violeta', 'virgen', 'virtud', 'virus', 'visera', 'visible', 'visi칩n', 'visita', 'visitar', 'v칤spera', 'vista', 'viuda', 'vivir', 'vivo', 'vocablo', 'vocal', 'volar', 'volc치n', 'voluntad', 'volumen', 'volver', 'vos', 'vosotros', 'votaci칩n', 'votar', 'voto', 'voz', 'vuelo', 'vuelta', 'vuestro', 'vulgar'],
                'W': ['Wifi', 'Waffle', 'Web', 'waterpolo', 'whisky'], 
                'X': ['Xel', 'Xil칩fono', 'Taxi', 'texto', 'sexto', 'examen', '칠xito', '칩xido', 'ox칤geno', 'proximo', 't칩rax', 'boxeo', 'saxof칩n'],
                'Y': ['Yadiel', 'Yoy칩', 'y', 'ya', 'yacimiento', 'yate', 'yegua', 'yema', 'yerno', 'yeso', 'yo', 'yodo', 'yogur', 'yunque', 'zafiro', 'zanahoria', 'zapato', 'zarza', 'zona', 'zoo', 'zorro', 'zumo', 'zurdo'],
                'Z': ['Zapato', 'Zorro', 'zafiro', 'zanahoria', 'zapato', 'zarza', 'zona', 'zoo', 'zorro', 'zumo', 'zurdo', 'azul', 'az칰car', 'caza', 'cazar', 'cereza', 'coraz칩n', 'cruz', 'cruzar', 'diez', 'feliz', 'fuerza', 'garbanzo', 'gozar', 'haza침a', 'juez', 'juzgar', 'lanzar', 'lazo', 'luz', 'ma칤z', 'manzana', 'matiz', 'mezcla', 'nariz', 'nuez', 'paz', 'pez', 'pieza', 'plaza', 'pozo', 'ra칤z', 'raza', 'raz칩n', 'rechazo', 'riqueza', 'taza', 'terraza', 'trozo', 'vez', 'voz'] 
            };

            const vowels = ['A', 'E', 'I', 'O', 'U'];
            const consonants = ['B', 'C', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', '칌', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'X', 'Y', 'Z'];

            // --- FUNCIONES AUXILIARES ---
            const speakText = (text, rate = 0.85) => {
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text.toLowerCase());
                    utterance.lang = 'es-ES';
                    utterance.rate = rate;
                    window.speechSynthesis.speak(utterance);
                }
            };

            const getSyllablePronunciation = (consonant, vowel) => {
                let c = consonant.toUpperCase();
                let v = vowel.toUpperCase();
                let textToSpeak = (consonant + vowel).toLowerCase();
                
                if (c === 'X') {
                    textToSpeak = 's' + v.toLowerCase();
                } else if (c === 'Y') {
                    if (v === 'U') textToSpeak = 'llu';
                    else if (v === 'I') textToSpeak = 'lli';
                } else if (c === 'Q') {
                    if (v === 'E' || v === 'I') textToSpeak = 'qu' + v.toLowerCase();
                    else textToSpeak = 'k' + v.toLowerCase();
                } else if (c === 'T' && v === 'O') {
                    textToSpeak = 'to'; 
                } else if (c === 'G') {
                    if (v === 'A') textToSpeak = 'ga'; // Aseguramos sonido suave
                    else if (v === 'O') textToSpeak = 'go'; 
                    else if (v === 'U') textToSpeak = 'gu';
                } else if (c === 'J' && v === 'E') {
                    textToSpeak = 'je'; 
                }
                return textToSpeak;
            };

            // --- HANDLERS MODO LETRAS ---
            const handleLetterClick = (letter) => {
                setSelectedLetter(letter);
                setAnimationClass('scale-110');
                setTimeout(() => setAnimationClass(''), 200);
                const examples = letterData[letter] || ['Palabra'];
                const randomExample = examples[Math.floor(Math.random() * examples.length)];
                setCurrentExample(randomExample);
                
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const sound = (phoneticSounds[letter] !== undefined ? phoneticSounds[letter] : letter).toLowerCase();
                    const utteranceLetter = new SpeechSynthesisUtterance(sound);
                    utteranceLetter.lang = 'es-ES'; 
                    utteranceLetter.rate = 0.9;
                    const utteranceWord = new SpeechSynthesisUtterance(randomExample.toLowerCase());
                    utteranceWord.lang = 'es-ES';
                    utteranceWord.rate = 0.9;
                    
                    utteranceLetter.onend = () => {
                        setTimeout(() => window.speechSynthesis.speak(utteranceWord), 500);
                    };
                    window.speechSynthesis.speak(utteranceLetter);
                }
            };

            // --- HANDLERS MODO S칈LABAS ---
            const handleSyllableVowel = (vowel) => {
                if (!syllableConsonant) return; 
                setSyllableVowel(vowel);
                let syllable = syllableConsonant + vowel;
                setFormedSyllable(syllable);
                
                const allWords = Object.values(letterData).flat();
                const foundWord = allWords.find(word => 
                    word.toLowerCase().includes(syllable.toLowerCase())
                ) || ''; 
                
                setSyllableExample(foundWord);
                
                const textToSpeak = getSyllablePronunciation(syllableConsonant, vowel);

                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utteranceSyllable = new SpeechSynthesisUtterance(textToSpeak);
                    utteranceSyllable.lang = 'es-ES';
                    utteranceSyllable.rate = 0.8;

                    const utteranceWord = new SpeechSynthesisUtterance(foundWord.toLowerCase());
                    utteranceWord.lang = 'es-ES';
                    utteranceWord.rate = 0.9;

                    utteranceSyllable.onend = () => {
                        if (foundWord) setTimeout(() => window.speechSynthesis.speak(utteranceWord), 500);
                    };
                    window.speechSynthesis.speak(utteranceSyllable);
                }
            };

            // --- HANDLERS MODO ESCRITURA ---
            const addLetterToWord = (letter) => {
                let finalLetter = letter;
                if (isAccentActive && accentedVowels[letter]) {
                    finalLetter = accentedVowels[letter];
                    setIsAccentActive(false);
                } else if (isAccentActive) {
                    setIsAccentActive(false);
                }
                setWrittenWord(prev => prev + finalLetter);
            };

            const deleteLastLetter = () => {
                setWrittenWord(prev => prev.slice(0, -1));
            };

            const clearWord = () => {
                setWrittenWord('');
                setIsAccentActive(false);
            };

            const readFullWord = () => {
                if (writtenWord.length > 0) {
                    speakText(writtenWord, 0.8);
                }
            };

            // --- HANDLERS MODO P츼RRAFO SONORO ---
            const handleParaLetterClick = (letter) => {
                if (currentParaLetters.length < 3) {
                    setCurrentParaLetters([...currentParaLetters, letter]);
                }
            };

            const clearParaSelection = () => {
                setCurrentParaLetters([]);
            };

            const confirmParaSyllable = () => {
                const syllable = currentParaLetters.join('');
                if (paragraphPhase === 'setup1') {
                    setParaSyllable1(syllable);
                    setParagraphPhase('setup2');
                    setCurrentParaLetters([]);
                } else if (paragraphPhase === 'setup2') {
                    setParaSyllable2(syllable);
                    setParagraphPhase('memory');
                    generateParagraphText(paraSyllable1, syllable);
                }
            };

            const generateParagraphText = (s1, s2) => {
                const allWords = Object.values(letterData).flat();
                const syl1Lower = s1.toLowerCase();
                const syl2Lower = s2.toLowerCase();

                const getWord = (syl) => {
                    const real = allWords.find(w => w.toLowerCase().includes(syl));
                    if (real) return real;
                    
                    const prefixes = ['ca', 'bo', 'mu', 'li', 'sa', 'tro'];
                    const suffixes = ['lo', 'ma', 'te', 'so', 'pa', 'na'];
                    const usePrefix = Math.random() > 0.5;
                    
                    if (usePrefix) {
                        return prefixes[Math.floor(Math.random() * prefixes.length)] + syl;
                    } else {
                        return syl + suffixes[Math.floor(Math.random() * suffixes.length)];
                    }
                };

                const w1 = getWord(syl1Lower);
                const w2 = getWord(syl2Lower);
                const w3 = allWords.find(w => w.toLowerCase().includes(syl1Lower) && w !== w1) || getWord(syl1Lower); 
                const w4 = allWords.find(w => w.toLowerCase().includes(syl2Lower) && w !== w2) || getWord(syl2Lower);

                const lines = [
                    `En el patio del cole encontramos un ${w1}.`,
                    `Estaba jugando muy feliz con su amigo ${w2}.`,
                    `De repente apareci칩 un ${w3} saltando.`,
                    `Nos dijo que quer칤a ir a ver el ${w4}.`,
                    `Todos juntos corrimos detr치s del ${w1}.`,
                    `Y terminamos merendando con el ${w2}.`
                ];
                
                const fullText = lines.join('\n');
                const words = fullText.split(/[\s\n]+/);
                setParagraphTextWords(words);
                setFoundWords([]);
            };

            const handleWordClick = (word, index) => {
                const cleanWord = word.toLowerCase().replace(/[.,!춰?쯓/g, "");
                const cleanS1 = paraSyllable1.toLowerCase();
                const cleanS2 = paraSyllable2.toLowerCase();

                if (cleanWord.includes(cleanS1) || cleanWord.includes(cleanS2)) {
                    if (!foundWords.includes(index)) {
                        setFoundWords([...foundWords, index]);
                        const utterance = new SpeechSynthesisUtterance("춰Bien!");
                        utterance.rate = 1.5;
                        window.speechSynthesis.speak(utterance);
                    }
                }
            };

            const readParagraph = () => {
                const fullText = paragraphTextWords.join(' ');
                speakText(fullText, 0.6);
            };

            return (
                <div className="p-2 md:p-8 pb-20 max-w-7xl mx-auto">
                    
                    <header className="flex flex-col items-center mb-6 gap-4">
                        <h1 className="text-2xl md:text-5xl font-extrabold text-indigo-600 drop-shadow-sm flex items-center justify-center gap-3 text-center">
                            <Sparkles className="text-yellow-400 hidden sm:block" size={32}/>
                            Conciencia fonol칩gica
                            <Sparkles className="text-yellow-400 hidden sm:block" size={32}/>
                        </h1>
                        
                        <div className="bg-white p-1 rounded-full shadow-lg flex border-2 border-indigo-100 overflow-x-auto max-w-full w-full md:w-auto scrollbar-hide">
                            <button onClick={() => setMode('alphabet')} className={`flex items-center gap-2 px-4 py-2 rounded-full font-bold transition-all whitespace-nowrap text-sm md:text-base ${mode === 'alphabet' ? 'bg-indigo-500 text-white shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}>
                                <Layout size={18} /> Letras
                            </button>
                            <button onClick={() => setMode('syllables')} className={`flex items-center gap-2 px-4 py-2 rounded-full font-bold transition-all whitespace-nowrap text-sm md:text-base ${mode === 'syllables' ? 'bg-pink-500 text-white shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}>
                                <Grid size={18} /> S칤labas
                            </button>
                            <button onClick={() => setMode('writing')} className={`flex items-center gap-2 px-4 py-2 rounded-full font-bold transition-all whitespace-nowrap text-sm md:text-base ${mode === 'writing' ? 'bg-orange-500 text-white shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}>
                                <PenTool size={18} /> Escritura
                            </button>
                            <button onClick={() => { setMode('paragraph'); setParagraphPhase('setup1'); setCurrentParaLetters([]); setParaSyllable1(''); setParaSyllable2(''); }} className={`flex items-center gap-2 px-4 py-2 rounded-full font-bold transition-all whitespace-nowrap text-sm md:text-base ${mode === 'paragraph' ? 'bg-green-500 text-white shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}>
                                <BookOpen size={18} /> P치rrafo loco
                            </button>
                        </div>
                    </header>

                    {/* --- MODO 1: LETRAS --- */}
                    {mode === 'alphabet' && (
                        <div className="max-w-6xl mx-auto space-y-8 animate-fade-in">
                            <div className="bg-white rounded-3xl shadow-2xl p-6 flex flex-col items-center justify-center min-h-[180px] md:min-h-[220px] border-4 border-indigo-200 max-w-3xl mx-auto mb-8">
                                {selectedLetter ? (
                                    <div className="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-12 w-full animate-fade-in">
                                        <div className={`text-8xl md:text-[10rem] font-black text-indigo-500 transition-transform ${animationClass}`}>
                                            {selectedLetter}
                                        </div>
                                        <div className="flex flex-col items-center sm:items-start">
                                            <div className="flex items-center gap-2 text-indigo-400 mb-1 uppercase tracking-wider text-xs font-bold bg-indigo-50 px-3 py-1 rounded-full">
                                                <Volume2 size={14} /> Pronunciando...
                                            </div>
                                            <div className="text-5xl md:text-7xl font-bold text-gray-800 capitalize text-center sm:text-left leading-tight">
                                                {currentExample}
                                            </div>
                                        </div>
                                    </div>
                                ) : <div className="text-gray-400 text-xl font-bold text-center">춰Pulsa una letra para saludar a tus compa침eros y profes!</div>}
                            </div>

                            <section className="bg-white/80 rounded-3xl p-6 shadow-xl border-b-8 border-pink-300 max-w-3xl mx-auto">
                                <h2 className="text-center text-pink-600 font-black text-2xl mb-4">Vocales</h2>
                                <div className="grid grid-cols-5 gap-3 px-4 md:px-12">
                                    {vowels.map(l => (
                                        <button key={l} onClick={() => handleLetterClick(l)} className="aspect-square bg-pink-500 text-white rounded-xl text-3xl font-bold shadow-md hover:-translate-y-1 transition-all flex items-center justify-center border-b-4 border-pink-700">{l}</button>
                                    ))}
                                </div>
                            </section>

                            <section className="bg-white/80 rounded-3xl p-6 shadow-xl border-b-8 border-indigo-300">
                                <h2 className="text-indigo-600 font-black text-2xl mb-4 ml-2">Consonantes</h2>
                                <div className="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-11 gap-2">
                                    {consonants.map(l => (
                                        <button key={l} onClick={() => handleLetterClick(l)} className="aspect-square bg-white text-indigo-600 rounded-xl text-xl md:text-2xl font-bold border-2 border-indigo-100 hover:border-indigo-400 shadow-sm transition-all flex items-center justify-center">{l}</button>
                                    ))}
                                </div>
                            </section>
                        </div>
                    )}

                    {/* --- MODO 2: S칈LABAS --- */}
                    {mode === 'syllables' && (
                        <div className="max-w-5xl mx-auto animate-fade-in">
                            <div className="bg-white rounded-3xl shadow-2xl p-6 mb-8 border-4 border-pink-200 min-h-[180px] md:min-h-[250px] flex flex-col items-center justify-center transition-all max-w-4xl mx-auto px-4">
                                {!syllableConsonant ? (
                                    <div className="text-center text-gray-400">
                                        <p className="text-2xl font-bold text-indigo-400">1. Elige una Consonante abajo 游녢</p>
                                    </div>
                                ) : !syllableVowel ? (
                                    <div className="text-center">
                                        <div className="text-[8rem] md:text-[10rem] font-black text-indigo-200 leading-none">{syllableConsonant}</div>
                                        <p className="text-xl font-bold text-pink-500 animate-bounce mt-4">2. 춰Ahora elige una Vocal! 游녡</p>
                                    </div>
                                ) : (
                                    <div className="flex flex-col sm:flex-row items-center justify-center gap-6 sm:gap-16 w-full animate-fade-in">
                                        <div className="text-[8rem] md:text-[10rem] font-black leading-none flex items-center">
                                            <span className="text-indigo-500">{syllableConsonant}</span>
                                            <span className="text-pink-500">{syllableVowel}</span>
                                        </div>
                                        <div className="flex flex-col items-center sm:items-start text-center sm:text-left">
                                            {syllableExample ? (
                                                <>
                                                    <div className="flex items-center gap-2 text-indigo-400 mb-1 uppercase tracking-wider text-xs font-bold bg-indigo-50 px-3 py-1 rounded-full w-fit">
                                                        <Volume2 size={14} /> La lleva la palabra...
                                                    </div>
                                                    <div className="text-5xl md:text-7xl font-bold text-gray-700 capitalize leading-tight">
                                                        {syllableExample}
                                                    </div>
                                                </>
                                            ) : (
                                                <p className="text-gray-400 italic">No encuentro palabras con "{syllableConsonant}{syllableVowel}" en tu lista.</p>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <section className="mb-6 bg-white/90 rounded-2xl p-4 shadow-lg border-b-4 border-pink-300 max-w-xl mx-auto">
                                <h3 className="text-center text-pink-600 font-bold text-xs uppercase tracking-widest mb-3">Vocales</h3>
                                <div className="flex gap-3 justify-center">
                                    {vowels.map(v => (
                                        <button key={v} onClick={() => handleSyllableVowel(v)} disabled={!syllableConsonant} className={`w-14 h-14 rounded-xl text-2xl font-bold border-b-4 flex items-center justify-center transition-all ${!syllableConsonant ? 'bg-gray-100 text-gray-300 border-gray-200 cursor-not-allowed' : syllableVowel === v ? 'bg-pink-600 text-white border-pink-800 scale-110 shadow-lg' : 'bg-pink-100 text-pink-600 border-pink-200 hover:bg-pink-200'}`}>{v}</button>
                                    ))}
                                </div>
                            </section>

                            <section className="bg-white/90 rounded-3xl p-6 shadow-lg border-b-4 border-indigo-300">
                                <h3 className="text-center text-indigo-600 font-bold text-xs uppercase tracking-widest mb-4">Consonantes</h3>
                                <div className="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-11 gap-2">
                                    {consonants.map(c => (
                                        <button key={c} onClick={() => { setSyllableConsonant(c); setSyllableVowel(null); setFormedSyllable(''); setSyllableExample(''); }} className={`aspect-square rounded-xl text-2xl font-bold border-b-4 flex items-center justify-center transition-all ${syllableConsonant === c ? 'bg-indigo-600 text-white border-indigo-800 scale-105 shadow-xl' : 'bg-white text-indigo-600 border-indigo-100 hover:border-indigo-400'}`}>{c}</button>
                                    ))}
                                </div>
                            </section>
                        </div>
                    )}

                    {/* --- MODO 3: ESCRITURA --- */}
                    {mode === 'writing' && (
                        <div className="max-w-6xl mx-auto animate-fade-in space-y-6 px-2">
                            <div className="bg-white rounded-3xl shadow-2xl p-8 border-4 border-orange-200 min-h-[200px] flex flex-col items-center justify-center relative bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] [background-size:20px_20px]">
                                <div className="absolute top-4 left-4 flex gap-2">
                                    <button onClick={clearWord} className="p-3 bg-red-100 text-red-600 rounded-full hover:bg-red-200 transition-colors shadow-sm" title="Borrar todo">
                                        <Trash2 size={24} />
                                    </button>
                                    <button onClick={deleteLastLetter} className="p-3 bg-yellow-100 text-yellow-600 rounded-full hover:bg-yellow-200 transition-colors shadow-sm" title="Borrar 칰ltima">
                                        <Eraser size={24} />
                                    </button>
                                </div>
                                
                                <div className="absolute top-4 right-4">
                                    <button onClick={readFullWord} className="p-4 bg-green-500 text-white rounded-full hover:bg-green-600 transition-transform active:scale-95 shadow-lg flex items-center gap-2" title="Leer palabra">
                                        <Volume2 size={24} />
                                        <span className="font-bold hidden sm:inline">Leer palabra</span>
                                    </button>
                                </div>

                                <div className="text-4xl md:text-8xl font-black text-gray-800 tracking-wider break-all text-center mt-8 uppercase">
                                    {writtenWord || <span className="text-gray-200 select-none normal-case text-2xl md:text-4xl">춰Escribe lo que quieras!</span>}
                                </div>
                            </div>

                            <section className="bg-white/80 rounded-2xl p-4 shadow-xl border-b-4 border-pink-300 max-w-2xl mx-auto">
                                <div className="flex gap-3 justify-center items-center">
                                    <button 
                                        onClick={() => setIsAccentActive(!isAccentActive)} 
                                        className={`w-12 h-12 md:w-14 md:h-14 rounded-xl text-3xl font-black shadow transition-all flex items-center justify-center border-b-4 ${isAccentActive ? 'bg-orange-500 text-white border-orange-700 animate-pulse' : 'bg-gray-100 text-gray-600 border-gray-300'}`}
                                        title="Poner tilde"
                                    >
                                        췂
                                    </button>
                                    <div className="w-px h-10 bg-gray-200 mx-2"></div>
                                    {vowels.map(v => (
                                        <button key={v} onClick={() => addLetterToWord(v)} className="w-12 h-12 md:w-14 md:h-14 bg-pink-500 text-white rounded-xl text-2xl font-bold shadow hover:-translate-y-1 transition-all active:scale-90 flex items-center justify-center border-b-4 border-pink-700">{v}</button>
                                    ))}
                                </div>
                            </section>

                            <section className="bg-white/80 rounded-3xl p-6 shadow-xl border-b-4 border-indigo-300">
                                <div className="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-11 gap-2">
                                    {consonants.map(c => (
                                        <button key={c} onClick={() => addLetterToWord(c)} className="aspect-square bg-white text-indigo-600 rounded-xl text-xl md:text-2xl font-bold border-2 border-indigo-100 hover:border-indigo-400 shadow-sm transition-all active:scale-90 flex items-center justify-center">{c}</button>
                                    ))}
                                </div>
                            </section>
                        </div>
                    )}

                    {/* --- MODO 4: P츼RRAFO SONORO --- */}
                    {mode === 'paragraph' && (
                        <div className="max-w-6xl mx-auto animate-fade-in space-y-6 px-2">
                            
                            {(paragraphPhase === 'setup1' || paragraphPhase === 'setup2') && (
                                <>
                                    <div className="bg-white rounded-3xl shadow-2xl p-8 border-4 border-green-200 min-h-[200px] flex flex-col items-center justify-center text-center">
                                        <h2 className="text-2xl md:text-4xl font-bold text-green-600 mb-4">
                                            {paragraphPhase === 'setup1' ? 'Elige 3 letras para la 1춹 S칤laba' : 'Elige 3 letras para la 2춹 S칤laba'}
                                        </h2>
                                        <div className="flex gap-4 mb-6">
                                            {currentParaLetters.map((l, i) => (
                                                <div key={i} className="w-16 h-16 md:w-20 md:h-20 bg-green-500 text-white rounded-2xl flex items-center justify-center text-4xl md:text-5xl font-black animate-fade-in">{l.toLowerCase()}</div>
                                            ))}
                                            {[...Array(3 - currentParaLetters.length)].map((_, i) => (
                                                <div key={i} className="w-16 h-16 md:w-20 md:h-20 border-4 border-dashed border-green-200 rounded-2xl"></div>
                                            ))}
                                        </div>
                                        
                                        <div className="flex gap-4">
                                            <button onClick={clearParaSelection} disabled={currentParaLetters.length === 0} className="px-6 py-3 bg-gray-200 text-gray-600 rounded-full font-bold hover:bg-gray-300 transition-colors disabled:opacity-50">Borrar</button>
                                            <button onClick={confirmParaSyllable} disabled={currentParaLetters.length < 3} className="px-8 py-3 bg-green-600 text-white rounded-full font-bold text-xl hover:bg-green-700 transition-transform active:scale-95 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                                                {paragraphPhase === 'setup1' ? 'Siguiente' : '춰Listo!'}
                                            </button>
                                        </div>
                                    </div>

                                    <section className="bg-white/80 rounded-2xl p-4 shadow-xl border-b-4 border-green-300 max-w-2xl mx-auto">
                                        <div className="flex gap-2 justify-center">
                                            {vowels.map(v => (
                                                <button key={v} onClick={() => handleParaLetterClick(v.toLowerCase())} disabled={currentParaLetters.length >= 3} className="w-12 h-12 bg-pink-500 text-white rounded-xl text-2xl font-bold shadow hover:-translate-y-1 transition-all flex items-center justify-center border-b-4 border-pink-700 disabled:opacity-50 lowercase">{v.toLowerCase()}</button>
                                            ))}
                                        </div>
                                    </section>
                                    <section className="bg-white/80 rounded-3xl p-6 shadow-xl border-b-4 border-green-300">
                                        <div className="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-11 gap-2">
                                            {consonants.map(c => (
                                                <button key={c} onClick={() => handleParaLetterClick(c.toLowerCase())} disabled={currentParaLetters.length >= 3} className="aspect-square bg-white text-indigo-600 rounded-xl text-xl font-bold border-2 border-indigo-100 hover:border-indigo-400 shadow-sm transition-all flex items-center justify-center disabled:opacity-50 lowercase">{c.toLowerCase()}</button>
                                            ))}
                                        </div>
                                    </section>
                                </>
                            )}

                            {paragraphPhase === 'memory' && (
                                <div className="bg-white rounded-3xl shadow-2xl p-10 border-4 border-green-200 min-h-[400px] flex flex-col items-center justify-center text-center animate-fade-in">
                                    <div className="flex gap-8 mb-8">
                                        <div className="text-7xl md:text-9xl font-black text-indigo-500 animate-pulse">{paraSyllable1}</div>
                                        <div className="text-7xl md:text-9xl font-black text-pink-500 animate-pulse delay-100">{paraSyllable2}</div>
                                    </div>
                                    <h2 className="text-3xl md:text-5xl font-black text-green-600 animate-bounce mb-8">
                                        춰RECU칄RDALAS, ATENTO!
                                    </h2>
                                    <button onClick={() => setParagraphPhase('reading')} className="px-8 py-4 bg-green-500 text-white rounded-full font-bold text-2xl hover:bg-green-600 shadow-xl transition-transform hover:scale-105">
                                        Leer Texto
                                    </button>
                                </div>
                            )}

                            {paragraphPhase === 'reading' && (
                                <div className="bg-white rounded-3xl shadow-2xl p-6 md:p-10 border-4 border-green-200 min-h-[400px] flex flex-col items-center animate-fade-in relative">
                                    
                                    <div className="flex items-center gap-2 mb-4 bg-yellow-50 text-yellow-700 px-4 py-2 rounded-lg border border-yellow-200 w-full max-w-4xl">
                                        <Info size={20} />
                                        <p className="text-sm font-medium">Atenci칩n: Este texto puede contener palabras inventadas si no encontramos reales con tus s칤labas.</p>
                                    </div>

                                    <div className="absolute top-4 right-4 flex gap-3 opacity-50">
                                        <span className="bg-indigo-100 text-indigo-600 px-2 py-1 rounded font-bold">{paraSyllable1}</span>
                                        <span className="bg-pink-100 text-pink-600 px-2 py-1 rounded font-bold">{paraSyllable2}</span>
                                    </div>

                                    <div className="w-full max-w-4xl text-left mb-8 mt-4 leading-loose">
                                        {paragraphTextWords.map((word, i) => {
                                            const isNewLine = word.endsWith('\n');
                                            const cleanW = word.trim();
                                            return (
                                                <React.Fragment key={i}>
                                                    <span 
                                                        onClick={() => handleWordClick(cleanW, i)}
                                                        className={`inline-block mr-2 text-2xl md:text-4xl cursor-pointer transition-all px-1 rounded-lg select-none mb-2
                                                            ${foundWords.includes(i) 
                                                                ? 'bg-yellow-300 text-black font-black transform scale-110 shadow-sm border-2 border-yellow-400' 
                                                                : 'hover:bg-green-50 text-gray-700'
                                                            }`}
                                                    >
                                                        {cleanW}
                                                    </span>
                                                    {isNewLine && <br />}
                                                </React.Fragment>
                                            );
                                        })}
                                    </div>

                                    <div className="flex gap-4 mt-auto">
                                        <button onClick={readParagraph} className="flex items-center gap-3 px-8 py-4 bg-green-600 text-white rounded-full font-bold text-xl hover:bg-green-700 shadow-lg transition-transform active:scale-95">
                                            <Volume2 size={24} /> Escuchar Texto
                                        </button>
                                        <button onClick={() => { setParagraphPhase('setup1'); setParaSyllable1(''); setParaSyllable2(''); setCurrentParaLetters([]); setFoundWords([]); }} className="px-6 py-4 bg-gray-200 text-gray-600 rounded-full font-bold hover:bg-gray-300">
                                            Reiniciar
                                        </button>
                                    </div>
                                    
                                    <p className="mt-4 text-gray-400 text-sm">Pulsa las palabras que tengan tus s칤labas m치gicas.</p>
                                </div>
                            )}

                        </div>
                    )}

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>